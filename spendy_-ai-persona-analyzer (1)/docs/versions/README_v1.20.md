
# Spendy: AI 페르소나 분석기 - 버전 1.20 요구사항 정의서

이 문서는 'Spendy' 웹 애플리케이션 버전 1.20의 기능적, 비기능적 요구사항을 정의합니다.

---

## 1. 버전 1.20 주요 변경 사항 요약

*   **로그인 경고창 표시 오류 수정**: 로그인 실패 시 경고창(`alert`)이 UI 렌더링에 묻혀 표시되지 않는 현상을 해결하여, 사용자가 오류 상황을 확실히 인지할 수 있도록 개선.
*   **네트워크 안정성 강화**: 모든 API 요청에 타임아웃(Timeout) 로직을 적용하여 서버 무응답 시 앱이 무한 로딩에 빠지는 것을 방지.
*   **보안 및 데이터 무결성 강화**: 사용자 입력값에 대한 공백 제거(Sanitization) 및 서버 응답 데이터 타입 검증 로직 추가.

---

## 2. 상세 기능 요구사항

### 2.1. 사용자 인증 프로세스 개선
-   **확실한 오류 피드백**:
    -   로그인 또는 회원가입 실패 시, 로딩 상태(`authLoading`)를 먼저 해제한 후 `setTimeout`을 이용하여 비동기적으로 경고창(`alert`)을 띄운다. 이를 통해 브라우저의 UI 업데이트 사이클과 경고창 호출이 충돌하는 것을 방지한다.
-   **입력값 자동 정제 (Sanitization)**:
    -   사용자가 입력한 닉네임과 비밀번호의 앞뒤 공백을 자동으로 제거(`trim`)한다. 실수로 포함된 공백으로 인해 로그인이 실패하거나, 공백이 포함된 닉네임이 생성되는 것을 방지한다.

### 2.2. 시스템 안정성 (System Stability)
-   **API 타임아웃 (Timeout)**:
    -   SheetDB와의 통신에 `fetchWithTimeout` 헬퍼 함수를 도입한다.
    -   10초 이상 서버 응답이 없을 경우 요청을 강제 중단(Abort)하고, "서버 응답 시간이 초과되었습니다"라는 명확한 오류 메시지를 사용자에게 전달한다.
-   **응답 검증 (Response Validation)**:
    -   서버로부터 받은 응답의 헤더(`Content-Type`)를 검사하여 JSON 형식이 아닐 경우(예: 서버 에러 HTML 페이지 등) 파싱을 시도하지 않고 에러 처리한다. 이는 앱이 멈추는 치명적인 오류(Crash)를 예방한다.

---

## 3. 비기능 요구사항

-   **사용자 경험(UX)**: 오류 발생 시 앱이 멈춘 것처럼 보이지 않도록 로딩 인디케이터를 적절한 시점에 제거해야 한다.
-   **코드 유지보수성**: 인증 관련 로직(`fetch`, `error handling`)을 `utils/auth.ts` 내부로 캡슐화하여 컴포넌트(`App.tsx`)의 복잡도를 낮춘다.
