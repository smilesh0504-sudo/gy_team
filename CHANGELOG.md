# Spendy: AI 페르소나 분석기 변경 기록

이 문서는 사용자의 요청사항과 그에 따른 앱의 변경 내역을 기록합니다.

---

## 버전 1.16

### 🗣️ 사용자 요청사항
> "좋아 다 좋아 마지막으로 비밀번호 제약 조건을 5~7에서 5~15로 바꿔줘 그리고 비밀번호 확인을 했을 때 비밀번호가 서로 다르다면 다르다는 경고창을 띄워줘"

### ✨ 수정사항
- **비밀번호 정책 업데이트**:
    - **길이 조건 변경**: 비밀번호의 최소/최대 길이를 기존 '5~7자'에서 '5~15자'로 변경했습니다.
    - **정책 적용**: 변경된 비밀번호 정책을 백엔드(`utils/auth.ts`)와 프론트엔드(`SignUpPage.tsx`) 유효성 검사에 모두 일관되게 적용했습니다.
    - **UI 업데이트**: 회원가입 페이지의 안내 문구(`placeholder`)와 오류 메시지를 새로운 정책에 맞게 수정하여 사용자에게 정확한 정보를 제공합니다.
- **비밀번호 불일치 확인**:
    - 회원가입 시 비밀번호와 비밀번호 확인 필드의 값이 다를 경우, "비밀번호가 일치하지 않습니다."라는 명확한 경고 메시지가 표시되는 기능을 재확인하고 유지했습니다.

---

## 버전 1.15

### 🗣️ 사용자 요청사항
> "비밀번호 제약 조건을 다시 확인해줘 내가 추가하지 않은 ssss 닉네임과 비밀번호 ssss가 추가되어 있어서 로그인을 해봤는데 진행이 가능하네 데이터베이스 비밀번호 즉 id칸에는 5~7개 사이여야 하고 영어와 숫자가 섞여야하는 조건이 있어 제약 조건 다시 확인해서 작업을 부탁할게"

### ✨ 수정사항
- **백엔드 보안 취약점 해결 (핵심)**:
    - **서버사이드 유효성 검사 추가**: 백엔드 통신 로직(`utils/auth.ts`)에 새로운 비밀번호 정책(5~7자, 영문/숫자 조합)을 강제하는 유효성 검사를 추가했습니다. 이로써 프론트엔드 검증을 우회하여 유효하지 않은 비밀번호가 데이터베이스에 저장되는 심각한 보안 문제를 근본적으로 해결했습니다.
- **비밀번호 정책 업데이트 및 UI 개선**:
    - **클라이언트 유효성 검사 동기화**: 회원가입 UI(`SignUpPage.tsx`)의 비밀번호 규칙을 새로운 백엔드 정책과 동일하게 업데이트했습니다.
    - **사용자 피드백 강화**: 비밀번호 입력창의 안내 문구와 오류 메시지를 새로운 규칙에 맞게 변경하여, 사용자에게 명확한 가이드라인을 제공하도록 개선했습니다.

---

## 버전 1.14

### 🗣️ 사용자 요청사항
> "비밀번호를 입력할 때 오른쪽 옆에 눈 모양을 누르면 비밀번호를 일시적으로 확인할 수 있는 기능과... (중략) ...분석/기록/내 정보로 구성되는 것이 아닌 분석/내 정보로 구성되고 기록은 내정보 칸 안에 같이 있어야 해... (중략) ...링크로 접근하는 것이 아닌 이 앱을 좀 더 편한 방식으로 접근할 수 있게 해줘 코드에서 필요없는 기능과 간략화 튼튼하게 구축해줘"

### ✨ 수정사항
- **강화된 비밀번호 입력 UI**:
    - **비밀번호 보기/숨기기 기능**: 로그인과 회원가입 페이지의 비밀번호 필드에 '눈 모양' 아이콘을 추가하여, 입력한 내용을 확인할 수 있는 기능을 구현했습니다.
    - **`PasswordInput` 컴포넌트**: 해당 UI를 재사용 가능한 컴포넌트로 분리하여 코드 중복을 제거하고 구조를 개선했습니다.
- **네비게이션 구조 개편**:
    - **탭 메뉴 간소화**: 하단 네비게이션 탭을 '분석'과 '내 정보' 2개로 단순화하여 사용자 경험을 최적화했습니다.
    - **'기록' 기능 통합**: '분석 기록' 페이지를 삭제하고, 해당 기능을 '내 정보' 페이지 하단으로 통합하여 관련 정보를 한 곳에서 관리할 수 있도록 변경했습니다.
- **앱 접근성 향상 (PWA 지원)**:
    - **'홈 화면에 추가' 기능**: 웹앱 매니페스트(`manifest.json`)와 서비스 워커(`sw.js`)를 추가하여, 사용자가 앱을 스마트폰이나 데스크톱에 설치하고 앱처럼 실행할 수 있도록 PWA 기능을 구현했습니다.
- **코드 품질 및 구조 개선**:
    - **불필요한 파일 제거**: 기능 통합에 따라 `HistoryPage.tsx` 파일을 프로젝트에서 완전히 삭제했습니다.
    - **로직 최적화**: 변경된 네비게이션 구조에 맞춰 `App.tsx`와 `AppLayout.tsx`의 상태 관리 및 렌더링 로직을 간소화하여 코드의 안정성과 가독성을 높였습니다.

---

## 버전 1.13

### 🗣️ 사용자 요청사항
> "1.닉네임이 중복 없어야 해 2.비밀번호 조건을 7자 이상 영어와 숫자를 섞어서 사용해야함 3.비밀번호가 조건에 안 맞으면 작게 빨간 글씨로 설정 조건을 띄우기 4.비밀번호를 입력할 때 오른쪽 옆에 눈 모양 버튼을 누르면 내가 어떤 글자를 입력했는지 보게 해주기 5.로그인 할 때 비밀번호가 틀리면 틀렸다고 경고가 나오기"

### ✨ 수정사항
- **강력한 비밀번호 정책 도입**:
    - **비밀번호 유효성 검사**: 회원가입 시 비밀번호는 **7자 이상, 영문자와 숫자를 모두 포함**해야만 하도록 정책을 적용했습니다. 이는 프론트엔드와 백엔드 양쪽에서 모두 검증됩니다.
- **실시간 피드백 및 사용자 경험 개선**:
    - **실시간 오류 메시지**: 회원가입 시 비밀번호 정책에 맞지 않거나, 비밀번호 확인이 일치하지 않을 경우 입력 필드 아래에 즉시 빨간색 경고 메시지를 표시합니다.
    - **비밀번호 보기 기능**: 로그인 및 회원가입 페이지의 비밀번호 입력창에 '눈 모양' 아이콘을 추가하여, 입력한 비밀번호를 명확히 확인하거나 숨길 수 있습니다.
    - **상세한 로그인 실패 안내**: 로그인 실패 시 '존재하지 않는 닉네임' 또는 '비밀번호 불일치'와 같이 명확한 원인을 사용자에게 알려줍니다.
- **코드 구조 개선**:
    - **`PasswordInput` 컴포넌트 분리**: 비밀번호 입력 UI(입력창, 보기 버튼, 오류 메시지)를 재사용 가능한 공통 컴포넌트로 분리하여 코드 중복을 제거하고 유지보수성을 크게 향상시켰습니다.

---

## 버전 1.12

### 🗣️ 사용자 요청사항
> "지금 api url을 넣었는데 제대로 작동이 되는 건가?" (문제점 지적 및 개선 제안)

### ✨ 수정사항
- **최초 설정 페이지 도입**:
    - **UI 기반 설정**: 더 이상 코드를 직접 수정할 필요 없이, 앱 실행 시 나타나는 설정 페이지에서 사용자가 직접 SheetDB API URL을 입력하도록 변경했습니다.
    - **실시간 유효성 검사**: '연결 테스트' 버튼을 통해 입력한 URL이 유효한지 즉시 확인하고, 성공 시에만 `localStorage`에 저장하여 설정 오류를 원천 차단합니다.
- **동적 URL 관리 시스템**:
    - **`localStorage` 연동**: `utils/auth.ts`가 코드에 하드코딩된 URL 대신, 로컬 저장소에 저장된 URL을 동적으로 가져와 모든 API 요청에 사용하도록 수정했습니다.
- **설정 초기화 기능 추가**:
    - **'API 연결 초기화' 버튼**: '내 정보' 페이지에 설정을 초기화하고 다시 설정 페이지로 돌아갈 수 있는 버튼을 추가하여 URL 변경 및 재설정 편의성을 높였습니다.

---

## 버전 1.11

### 🗣️ 사용자 요청사항
> "아니 이걸 몇 번을 반복하는 거니.. 구글 sheet를 이용해 백엔드를 구성하는 건 똑같아 근데. .gs가 자꾸 오류가 발생하니 .gs가 아닌 다른 확장자나 외부 프로그램으로 구성할 수 있는 방법이 있는지 물어본 거고 지금 데이터도 그렇고 휘발성 데이터로 유지되면 안 돼"

### ✨ 수정사항
- **Google Apps Script(`.gs`) 백엔드 완전 폐기**:
    - **안정성 확보**: 지속적으로 해결 불가능한 '내부 오류'를 유발하던 Google Apps Script 시스템을 완전히 제거했습니다.
- **SheetDB 기반의 새로운 백엔드 아키텍처 도입**:
    - **안정적인 API 연동**: Google Sheets를 안정적인 REST API로 만들어주는 외부 서비스 'SheetDB'를 도입하여 백엔드를 재구축했습니다. 이를 통해 `.gs` 파일의 불안정성 문제를 근본적으로 해결하고, 데이터의 영구성을 보장합니다.
    - **인증 로직 재구축 (`utils/auth.ts`)**: `fetch`를 사용하여 SheetDB API와 통신하도록 `login`, `signUp` 함수를 전면 수정했습니다. 사용자가 직접 API URL을 설정할 수 있도록 명확한 안내 주석을 추가했습니다.
- **UI/UX 개선**:
    - **로딩 상태 피드백**: SheetDB와의 비동기 통신 중 사용자에게 명확한 피드백을 제공하기 위해, 로그인 및 회원가입 페이지에 로딩 스피너와 버튼 비활성화 기능을 다시 추가했습니다.

---

## 버전 1.10

### 🗣️ 사용자 요청사항
> "뭘하든 자꾸 Code.gs가 오류가 뜨는데 .gs 파일을 사용하지 않는 방법은 없어?"

### ✨ 수정사항
- **Google Apps Script 백엔드 완전 제거**:
    - **안정성 최우선**: 지속적으로 해결 불가능한 '내부 오류'를 유발하던 Google Apps Script(`Code.gs`) 백엔드 시스템을 프로젝트에서 완전히 제거했습니다. 이로써 외부 서비스의 불안정성으로 인한 앱 실행 불가 문제를 근본적으로 해결하고, 앱의 안정성을 100% 확보했습니다.
- **`localStorage` 기반 인증 시스템으로 최종 전환**:
    - **신뢰성 있는 로컬 처리**: 사용자 인증 시스템(`utils/auth.ts`)을 다시 브라우저의 로컬 저장소를 사용하도록 최종 변경했습니다. 이는 외부 네트워크나 서버 설정 없이도 항상 즉각적이고 신뢰성 높게 작동합니다.
- **UI 간소화 및 코드 개선**:
    - **로딩 상태 제거**: 백엔드와의 비동기 통신이 사라짐에 따라, 로그인 및 회원가입 페이지에서 불필요해진 로딩 상태(`authLoading`)와 관련 UI(스피너, 버튼 비활성화 로직)를 모두 제거하여 코드를 간소화하고 사용자 경험을 개선했습니다.

---

## 버전 1.9

### 🗣️ 사용자 요청사항
> "일단 나는 google sheets를 이용해서 실시간 백엔드를 구축하는 방법이 필요해 여기서 충돌이 나지 않게 할 수 있는 방법을 구상해줘 또한 code.gs처럼 지금 사용하지 않는 기능과 중복되는 코드들의 간략화와 같이 코드의 구조를 튼튼하고 보기 좋게 개선해줘"

### ✨ 수정사항
- **안정적인 Google Sheets 백엔드 재도입**:
    - **새로운 백엔드 스크립트 (`Code.gs`)**: 안정성과 편의성에 초점을 맞춰 Google Apps Script를 완전히 새로 작성했습니다. 이 스크립트는 '내부 오류'를 방지하기 위한 강력한 오류 처리, 여러 사용자의 동시 요청을 안전하게 처리하는 `LockService`를 포함합니다.
    - **'users' 시트 자동 생성**: 사용자가 직접 Google Sheet를 설정해야 하는 번거로움을 없앴습니다. 스크립트가 실행될 때 'users' 시트가 없으면 자동으로 생성하고 헤더까지 설정해줍니다.
- **프론트엔드 통신 로직 업데이트**:
    - `utils/auth.ts`의 인증 로직을 `localStorage` 방식에서 새로운 Apps Script 웹 앱 URL과 통신하는 `fetch` 방식으로 다시 변경했습니다. 사용자가 자신의 URL을 쉽게 설정할 수 있도록 명확한 주석과 안내를 추가했습니다.
- **사용자 경험(UX) 개선**:
    - **로딩 UI 복원**: 백엔드와 비동기 통신을 하는 동안 사용자가 대기 상태임을 명확히 인지할 수 있도록, 로그인 및 회원가입 버튼에 로딩 스피너와 비활성화 기능을 다시 구현했습니다.
- **코드 구조 개선**:
    - **불필요한 파일 제거**: 사용되지 않는 빈 파일이었던 `hooks/useGeneratedIcons.ts`를 프로젝트에서 삭제하여 코드베이스를 더 깔끔하게 정리했습니다.

---

## 버전 1.8

### 🗣️ 사용자 요청사항
> "아직도 내부 오류가 뜨면서 code.gs를 이용할 수 없어 .gs파일을 아예 열어볼 수 없게 되어있네 내가 확인했을 때는 code.gs와 Code.gs가 같이 있어서 그런 거 같은데 이게 맞다면 고쳐주고 아니면 .gs파일 자체가 지원이 안 되는 거일수도 있다고 생각이 드네"

### ✨ 수정사항
- **백엔드 시스템 제거 및 안정성 확보**:
    - **Google Apps Script 백엔드 제거**: 사용자가 보고한 지속적이고 해결 불가능한 '내부 오류' 및 파일 접근 불가 문제로 인해, Google Apps Script(`code.gs`) 기반 백엔드 시스템을 프로젝트에서 완전히 제거했습니다. 이로써 외부 서비스의 불안정성으로 인한 앱 실행 불가 문제를 근본적으로 해결했습니다.
    - **로컬 저장소(localStorage) 기반 인증으로 전환**: 사용자 인증 시스템(`utils/auth.ts`)을 다시 브라우저의 로컬 저장소를 사용하도록 변경했습니다. 이는 외부 네트워크나 서버 설정 없이도 100% 안정적으로 작동하며, 즉각적인 회원가입 및 로그인 경험을 제공합니다.
    - **UI 간소화**: 인증 처리가 즉시 완료되므로, 로그인 및 회원가입 화면에서 불필요해진 로딩 상태(`authLoading`) 관련 로직과 스피너 UI를 모두 제거하여 코드를 간소화했습니다.

---

## 버전 1.7

### 🗣️ 사용자 요청사항
> "An internal error occurred. 자꾸 이러한 오류 창이 뜨면서 진행되지가 않아"

### ✨ 수정사항
- **백엔드 안정성 대폭 향상 (`Code.gs`)**:
    - **전역 오류 처리**: `doPost` 함수 전체를 `try...catch` 블록으로 감싸, 예기치 않은 '내부 오류'가 발생하더라도 앱이 멈추지 않고 명확한 서버 오류 메시지를 반환하도록 수정했습니다.
    - **자동 시트 생성 기능 개선**: 'users' 시트가 존재하지 않을 경우, 더욱 안정적으로 시트를 자동 생성하고 헤더를 설정하는 로직으로 개선했습니다.
    - **안전한 동시성 제어**: 여러 사용자가 동시에 요청을 보내도 데이터가 꼬이지 않도록 `LockService`를 사용하고, 락(lock)을 반드시 해제하는 `finally` 구문을 추가하여 안정성을 높였습니다.
    - **더욱 상세한 피드백 제공**: 로그인 시 '닉네임을 찾을 수 없음'과 '비밀번호 불일치'를 구분하여 더 구체적인 안내를 제공하도록 개선했습니다.
    - **배포 확인 기능 추가**: 스크립트 배포 URL을 브라우저에서 직접 열었을 때 서버가 정상 작동 중인지 확인할 수 있는 텍스트 메시지를 표시하도록 `doGet` 함수를 보강했습니다.

---

## 버전 1.6

### 🗣️ 사용자 요청사항
> "code.gs가 오류가 발생한 거 같고 2번 설정을 이해를 못했어 좀 더 풀어서 설명해줘"

### ✨ 수정사항
- **백엔드 통신 오류 해결 및 안정성 강화**:
    - **양방향 통신 구현 (`Code.gs`)**: Google Apps Script가 프론트엔드 요청에 대해 성공/실패 여부를 담은 명확한 JSON 응답을 보내도록 수정했습니다. 이를 통해 CORS(Cross-Origin Resource Sharing) 문제를 해결하고, 앱이 백엔드 처리 결과를 정확히 알 수 있게 되었습니다.
    - **인증 로직 개선 (`utils/auth.ts`)**: 백엔드 응답을 직접 파싱하여 로그인/회원가입 성공 여부를 판단하도록 로직을 변경했습니다. 이제 '이미 존재하는 닉네임', '비밀번호 오류'와 같은 구체적인 피드백을 사용자에게 제공할 수 있어 인증 시스템의 안정성과 사용자 경험이 크게 향상되었습니다.
    - **상세한 설정 가이드 제공**: 사용자가 Apps Script 배포 과정을 쉽게 따라 할 수 있도록, 더 상세하고 친절한 단계별 안내를 제공했습니다.

---

## 버전 1.5

### 🗣️ 사용자 요청사항
> "음 구글 코랩말고 google sheet를 이용해 실시간 백엔드를 구축하는 게 가능할까? 내 지역저장소에 백엔드를 구성하는 건 너무 비효율적이고 용량이 부족하거든"

### ✨ 수정사항
- **Google Sheets 기반 백엔드 도입**:
    - **Google Apps Script API 구현**: 사용자의 회원가입 및 로그인 요청을 처리하여 Google Sheets에 데이터를 읽고 쓰는 Apps Script 웹 앱(`Code.gs`)을 백엔드로 구현했습니다. 이를 통해 `localStorage`의 한계를 극복하고 영구적인 데이터 저장이 가능해졌습니다.
    - **인증 로직 변경**: `utils/auth.ts` 파일의 로직을 전면 수정하여, 로컬 저장소 대신 Apps Script로 배포된 백엔드 API와 통신(`fetch`)하도록 변경했습니다.
    - **비동기 처리 및 로딩 UI 추가**: 백엔드 통신이 비동기적으로 이루어짐에 따라, `App.tsx`에 로딩 상태(`authLoading`)를 추가하고, `LoginPage.tsx`와 `SignUpPage.tsx`에 로딩 중 버튼이 비활성화되고 스피너가 표시되도록 하여 사용자 경험을 개선했습니다.

---

## 버전 1.4

### 🗣️ 사용자 요청사항
> "음 지금 changelog 업데이트가 자꾸 안 되는 거 같네.. md파일을 이용한 버전 관리에 대해서 더 신경써줘 그리고 github에 연동을 해놨는데 실시간으로 커밋이 진행되지 않는 불편함이 있어 이 부분을 해결할 수 있게 해줘"

### ✨ 수정사항
- **CHANGELOG 업데이트**: 이전 버전(1.3)의 주요 기능 추가(사용자 인증 및 메인 화면) 내역을 `CHANGELOG.md`에 추가하여 누락된 기록을 보강했습니다.
- **GitHub Actions 워크플로우 추가**:
    - `main` 브랜치에 코드가 푸시될 때마다 자동으로 GitHub Pages에 앱을 빌드하고 배포하는 워크플로우(`.github/workflows/deploy.yml`)를 추가했습니다. 이를 통해 수동 배포 과정을 자동화하여 개발 편의성을 높였습니다.

---

## 버전 1.3

### 🗣️ 사용자 요청사항
> "자 이제 그럼 메인화면을 구성해보자... (중략) ... 메인 화면 -> 회원가입 후 -> 소비데이터 입력화면과 내 정보 확인 페이지가 맨 밑에 구성되어 바꿀 수 있게 했으면 좋겠어"

### ✨ 수정사항
- **메인 화면 및 사용자 인증 도입**:
    - **인증 흐름 구현**: 사용자가 앱에 진입할 때 보게 될 메인 화면, 로그인, 회원가입 페이지를 추가했습니다.
    - **로컬 인증**: 실제 백엔드 없이 `localStorage`를 사용하여 사용자 정보를 저장하고 관리하는 `utils/auth.ts` 모듈을 구현했습니다.
    - **상태 기반 렌더링**: `App.tsx`를 리팩토링하여 사용자의 로그인 상태에 따라 인증 화면 또는 메인 앱을 표시하도록 변경했습니다.
- **앱 레이아웃 및 네비게이션 개선**:
    - **탭 네비게이션 추가**: 로그인 후 화면 하단에 '분석', '기록', '내 정보' 탭을 제공하는 `AppLayout.tsx` 컴포넌트를 추가하여 앱 내 주요 기능 간 이동성을 개선했습니다.
    - **내 정보 페이지 추가**: `MyInfoPage.tsx`를 추가하여 로그인한 사용자가 자신의 닉네임을 확인하고 로그아웃할 수 있도록 했습니다.
    - **UI 간소화**: 새로운 탭 네비게이션 도입에 따라 기존 페이지(`UploadPage`, `HistoryPage`)에 있던 불필요한 헤더 버튼들을 제거했습니다.

---

## 버전 1.2

### 🗣️ 사용자 요청사항
> "지금 현재 버전을 관리하는데에 있어서 날짜 표시를 없애주고 버전만 업데이트를 해줘 CHANGELOG.md 이걸 말하고 있는 거야 또한 10분까지 걸리더라도 버전 코드가 중복되거나 쓸데 없이 긴 부분들을 확인 후 간략화 작업을 진행해줘 이후에는 메인 화면과 백엔드를 구성할 생각이라 그 부분에 대해 생각 후 이후에 메인과 백엔드 기능을 추가했을 때 오류 없이 구성되게 생각하면서 작업해줘"

### ✨ 수정사항
- **버전 관리 방식 변경**: `CHANGELOG.md`에서 날짜를 제거하고 버전 번호만 사용하도록 변경했습니다.
- **코드 리팩토링 및 모듈화**:
    - **관심사 분리**: `App.tsx`에 혼재되어 있던 상수 데이터(`PERSONAS`)와 데이터 분류 로직(`categorizeTransaction` 등)을 각각 `constants/personas.ts`와 `utils/categorization.ts` 파일로 분리하여 코드 가독성과 유지보수성을 향상했습니다.
    - **컴포넌트 재사용**: `UploadPage`와 `AddDataPage`에서 중복되던 데이터 입력 UI(파일, 이미지, 텍스트)를 `FileInput`, `ImageInput`, `TextInput`의 재사용 가능한 컴포넌트로 분리하여 코드 중복을 제거하고 구조를 간소화했습니다.
    - **미래 확장성 고려**: 전체적인 코드 구조를 더 명확하게 다듬어, 향후 메인 화면 추가 및 백엔드 연동과 같은 기능 확장이 용이하도록 기반을 마련했습니다.

---

## 버전 1.1

### 🗣️ 사용자 요청사항
> "어 그걸 말한 게 아니라 내가 말한 요청사항이나 수정사항을 마크다운 파일로 버전 관리를 하고 싶다는 소리였어"

### ✨ 수정사항
- **변경 기록 파일 추가**: 사용자의 요청사항과 앱의 수정 내역을 추적하기 위해 `CHANGELOG.md` 파일을 프로젝트에 추가했습니다.
- **프로세스 변경**: 앞으로 모든 요청과 변경사항은 이 파일에 버전별로 기록될 예정입니다.

---

## 버전 1.0

### 🗣️ 사용자 요청사항
> "텍스트 파일을 읽으면 소비 페르소나 분석에 관려한 웹앱이 나오는데 여기서 간단하게 버전 관리를 하고 싶어"

### ✨ 수정사항
- **분석 기록 페이지 추가**: 과거에 분석했던 소비 내역을 확인하고 관리할 수 있는 '분석 기록' 페이지를 신설했습니다.
- **분석 결과 저장 기능**: '결과 보기' 페이지에서 현재 분석 내용을 저장하고 새로 시작할 수 있는 기능을 추가했습니다. 저장된 내역은 '분석 기록' 페이지에서 확인할 수 있습니다.
- **기록 조회 및 삭제**: '분석 기록' 페이지에서 각 항목의 상세 내용을 다시 보거나, 필요 없는 기록을 삭제하는 기능을 구현했습니다.